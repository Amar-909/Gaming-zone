<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cosmic Plane Battle</title>
<style>
  body,html{margin:0;padding:0;overflow:hidden;background:black;color:white;font-family:sans-serif}
  canvas{display:block;margin:0 auto;background:radial-gradient(circle at center,#020018,#000010)}
  #hud{position:fixed;top:10px;left:50%;transform:translateX(-50%);display:flex;gap:20px;font-weight:bold}
</style>
</head>
<body>
<canvas id="game" width="720" height="540"></canvas>
<div id="hud">
  <div>Level: <span id="level">1</span></div>
  <div>Chances: <span id="lives">3</span></div>
  <div>Score: <span id="score">0</span></div>
</div>
<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
const W=canvas.width,H=canvas.height;
let level=1,lives=3,score=0;
let lastLevelUp=Date.now();

const player={x:W/2-20,y:H-80,w:40,h:40,bullets:[]};
const enemies=[];

function drawBackground(){
  const g=ctx.createLinearGradient(0,0,W,H);
  g.addColorStop(0,'#020018');g.addColorStop(1,'#000010');
  ctx.fillStyle=g;ctx.fillRect(0,0,W,H);
  for(let i=0;i<60;i++){
    ctx.fillStyle='white';ctx.fillRect(Math.random()*W,Math.random()*H,2,2);
  }
}

function drawPlayer(){
  ctx.fillStyle='cyan';
  ctx.beginPath();
  ctx.moveTo(player.x+player.w/2,player.y);
  ctx.lineTo(player.x,player.y+player.h);
  ctx.lineTo(player.x+player.w,player.y+player.h);
  ctx.closePath();
  ctx.fill();
}

function drawEnemies(){
  ctx.fillStyle='red';
  enemies.forEach(e=>{
    ctx.fillRect(e.x,e.y,e.w,e.h);
  });
}

function drawBullets(){
  ctx.fillStyle='yellow';
  player.bullets.forEach(b=>{
    ctx.fillRect(b.x,b.y,4,10);
  });
}

function updateBullets(){
  player.bullets.forEach(b=>b.y-=6);
  player.bullets=player.bullets.filter(b=>b.y>0);
}

function spawnEnemy(){
  const w=40,h=30;
  const x=Math.random()*(W-w);
  enemies.push({x,y:0,w,h,speed:1.5+level*0.3}); // slower & easier
}

function updateEnemies(){
  enemies.forEach(e=>{e.y+=e.speed;});
  enemies.forEach((e,i)=>{
    if(e.y+e.h>H){
      enemies.splice(i,1);
      lives--;
      if(lives<=0){gameOver();}
    }
  });
}

function checkHits(){
  enemies.forEach((e,ei)=>{
    player.bullets.forEach((b,bi)=>{
      if(b.x<e.x+e.w&&b.x+4>e.x&&b.y<e.y+e.h&&b.y+10>e.y){
        enemies.splice(ei,1);
        player.bullets.splice(bi,1);
        score+=10;
      }
    });
  });
}

function drawHUD(){
  document.getElementById('level').innerText=level;
  document.getElementById('lives').innerText=lives;
  document.getElementById('score').innerText=score;
}

function gameOver(){
  ctx.fillStyle='rgba(0,0,0,0.7)';ctx.fillRect(0,0,W,H);
  ctx.fillStyle='white';ctx.font='40px Arial';
  ctx.fillText('Game Over!',W/2-100,H/2);
  cancelAnimationFrame(loopId);
}

let keys={};
document.addEventListener('keydown',e=>{keys[e.key]=true;if(e.key===' '){player.bullets.push({x:player.x+player.w/2-2,y:player.y});}});
document.addEventListener('keyup',e=>{keys[e.key]=false;});

function movePlayer(){
  if(keys['ArrowLeft']) player.x-=6;
  if(keys['ArrowRight']) player.x+=6;
  if(keys['ArrowUp']) player.y-=6;
  if(keys['ArrowDown']) player.y+=6;
  player.x=Math.max(0,Math.min(W-player.w,player.x));
  player.y=Math.max(H/2,Math.min(H-player.h,player.y));
}

function levelUp(){
  if(Date.now()-lastLevelUp>30000){
    level++;
    lastLevelUp=Date.now();
  }
}

function loop(){
  drawBackground();
  movePlayer();
  drawPlayer();
  updateBullets();
  drawBullets();
  updateEnemies();
  drawEnemies();
  checkHits();
  drawHUD();
  levelUp();
  if(Math.random()<0.01+level*0.002) spawnEnemy(); // fewer enemies overall
  loopId=requestAnimationFrame(loop);
}
let loopId=requestAnimationFrame(loop);
</script>
</body>
</html>
